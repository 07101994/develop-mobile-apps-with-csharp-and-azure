<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>jQuery Applications - Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure</title>
      
      
      
        <link rel="canonical" href="https://adrianhall.github.io/develop-mobile-apps-with-csharp-and-azure/chapter6/jquery/">
      
      
        <meta name="author" content="Adrian Hall">
      
    
    <meta property="og:url" content="https://adrianhall.github.io/develop-mobile-apps-with-csharp-and-azure/chapter6/jquery/">
    <meta property="og:title" content="Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure">
    <meta property="og:image" content="https://adrianhall.github.io/develop-mobile-apps-with-csharp-and-azure/chapter6/jquery//../../">
    <meta name="apple-mobile-web-app-title" content="Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-a422ff04cc.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/vs.css">
    
    <script src="../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Chapter 6 - Combining Web and Mobile Apps <i class="icon icon-link"></i>
              
            
          </span>
        
        jQuery Applications
      </div>
    </div>
    
      
      <div class="button button-twitter" role="button" aria-label="Twitter">
        <a href="https://twitter.com/FizzyInTheHall" title="@FizzyInTheHall on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
      </div>
    
    
      
      <div class="button button-github" role="button" aria-label="GitHub">
        <a href="https://github.com/adrianhall" title="@adrianhall on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
      </div>
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>
          Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          adrianhall/develop-mobile-apps-with-csharp-and-azure
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Getting Started" href="../..">
      Getting Started
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Chapter 1 - Introduction</span>
    <ul>
      
        
  <li>
    <a class="" title="Your First App - PC Edition" href="../../chapter1/firstapp_pc/">
      Your First App - PC Edition
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Your First App - Mac Edition" href="../../chapter1/firstapp_mac/">
      Your First App - Mac Edition
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Chapter 2 - Authentication</span>
    <ul>
      
        
  <li>
    <a class="" title="Concepts" href="../../chapter2/authconcepts/">
      Concepts
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Authentication in the Backend" href="../../chapter2/backend/">
      Authentication in the Backend
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Enterprise Authentication" href="../../chapter2/enterprise/">
      Enterprise Authentication
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Social Authentication" href="../../chapter2/social/">
      Social Authentication
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Debugging Authentication" href="../../chapter2/debugging/">
      Debugging Authentication
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Custom Authentication" href="../../chapter2/custom/">
      Custom Authentication
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Claims and Authorization" href="../../chapter2/authorization/">
      Claims and Authorization
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Tokens in Real Apps" href="../../chapter2/realworld/">
      Tokens in Real Apps
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Best Practices" href="../../chapter2/bestpractices/">
      Best Practices
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Chapter 3 - Data Access and Offline Sync</span>
    <ul>
      
        
  <li>
    <a class="" title="Concepts" href="../../chapter3/dataconcepts/">
      Concepts
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Implementing Table Controllers" href="../../chapter3/server/">
      Implementing Table Controllers
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Data Projection and Queries" href="../../chapter3/projection/">
      Data Projection and Queries
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="The Mobile Client" href="../../chapter3/client/">
      The Mobile Client
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Relationships" href="../../chapter3/relationships/">
      Relationships
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="The Domain Manager" href="../../chapter3/domainmgr/">
      The Domain Manager
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Chapter 4 - Server Side Code</span>
    <ul>
      
        
  <li>
    <a class="" title="Options for Server Code" href="../../chapter4/options/">
      Options for Server Code
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Custom HTTP Endpoints" href="../../chapter4/custom/">
      Custom HTTP Endpoints
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="WebJobs" href="../../chapter4/webjobs/">
      WebJobs
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Functions" href="../../chapter4/functions/">
      Functions
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Recipes" href="../../chapter4/recipes/">
      Recipes
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Chapter 5 - Push Notifications</span>
    <ul>
      
        
  <li>
    <a class="" title="Concepts" href="../../chapter5/concepts/">
      Concepts
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Android Push" href="../../chapter5/android/">
      Android Push
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="iOS Push" href="../../chapter5/ios/">
      iOS Push
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Windows Push" href="../../chapter5/windows/">
      Windows Push
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Push Recipes" href="../../chapter5/recipes/">
      Push Recipes
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Chapter 6 - Combining Web and Mobile Apps</span>
    <ul>
      
        
  <li>
    <a class="" title="MVC Applications" href="../mvc/">
      MVC Applications
    </a>
    
  </li>

      
        
  <li>
    <a class="current" title="jQuery Applications" href="./">
      jQuery Applications
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="The JavaScript SDK and jQuery" href="#the-javascript-sdk-and-jquery">
                The JavaScript SDK and jQuery
              </a>
            </li>
          
            <li class="anchor">
              <a title="Reading Table Data" href="#reading-table-data">
                Reading Table Data
              </a>
            </li>
          
            <li class="anchor">
              <a title="Modifying Data" href="#modifying-data">
                Modifying Data
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
        
  <li>
    <a class="" title="Angular Applications" href="../angular/">
      Angular Applications
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="React Applications" href="../react/">
      React Applications
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Chapter 7 - Other Useful Services</span>
    <ul>
      
        
  <li>
    <a class="" title="Useful Azure Services" href="../../chapter7/services/">
      Useful Azure Services
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Azure Search" href="../../chapter7/search/">
      Azure Search
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Media Services" href="../../chapter7/media/">
      Media Services
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Real-time Notifications" href="../../chapter7/realtime/">
      Real-time Notifications
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Chapter 8 - Developing An App</span>
    <ul>
      
        
  <li>
    <a class="" title="The Development Environment" href="../../chapter8/developing/">
      The Development Environment
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Testing your Application" href="../../chapter8/testing/">
      Testing your Application
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Chapter 9 - Going to Production</span>
    <ul>
      
        
  <li>
    <a class="" title="Repeatable Deployments" href="../../chapter9/arm/">
      Repeatable Deployments
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Safe Deployments" href="../../chapter9/appsvc/">
      Safe Deployments
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Monitoring" href="../../chapter9/monitoring/">
      Monitoring
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Troubleshooting" href="../../chapter9/troubleshooting/">
      Troubleshooting
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="Xamarin Forms Tips" href="../../xamarin_tips/">
      Xamarin Forms Tips
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Android Developer Notes" href="../../android_appendix/">
      Android Developer Notes
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Visual Studio Extensions" href="../../vs_extensions/">
      Visual Studio Extensions
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="References" href="../../references/">
      References
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Credits" href="../../credits/">
      Credits
    </a>
    
  </li>

          
        </ul>
        
          <hr>
          <span class="section">The author</span>
          <ul>
            
              
              <li>
                <a href="https://twitter.com/FizzyInTheHall" target="_blank" title="@FizzyInTheHall on Twitter">
                  @FizzyInTheHall on Twitter
                </a>
              </li>
            
            
              
              <li>
                <a href="https://github.com/adrianhall" target="_blank" title="@adrianhall on GitHub">
                  @adrianhall on GitHub
                </a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="single-page-applications">Single Page Applications<a class="headerlink" href="#single-page-applications" title="Permanent link">&para;</a></h1>
<p>One of the major changes that has happened within web applications in the past few years is the single page application, or SPA,
coupled with the rise of JavaScript frameworks.  No-one can directly support all the JavaScript frameworks out there, but this
section will cover a couple of the main ones - <a href="http://jquery.com/">jQuery</a>, <a href="https://facebook.github.io/react/">React</a> and <a href="https://angularjs.org/">Angular2</a>.  Azure Mobile Apps has a <a href="https://www.npmjs.com/package/azure-mobile-apps-client">JavaScript SDK</a>
that can be used for accessing table controllers and identity services within your mobile backend.</p>
<h2 id="the-javascript-sdk-and-jquery">The JavaScript SDK and jQuery<a class="headerlink" href="#the-javascript-sdk-and-jquery" title="Permanent link">&para;</a></h2>
<p>iQuery has a long history in web development at this point.  It is easy to pick up and functionally great for small
applications.  The important thing to note here is that you cannot instantiate the Azure Mobile Apps client SDK until 
all the scripts are loaded.  Fortunately, JavaScript (and jQuery) provide events when this happens.  </p>
<p>I tend to add SPA applications to ASP.NET MVC apps by making the main HTML page a View.  First, add a controller 
called "Controllers\SPAController" with the following contents:</p>
<pre><code class="csharp">using System.Web.Mvc;

namespace Backend.Controllers
{
    public class SPAController : Controller
    {
        public ActionResult JQuery()
        {
            return View();
        }
    }
}
</code></pre>

<p>Also, create a directory <code>Views\SPA</code> and add a <code>JQuery.cshtml</code> file:</p>
<pre><code class="html">@{
    Layout = null;
}

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;
    &lt;title&gt;JQuery&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;~/Content/spa/jquery/application.css&quot;/&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id=&quot;wrapper&quot;&gt;
        &lt;article&gt;
            &lt;header&gt;
                &lt;h2&gt;Azure&lt;/h2&gt;
                &lt;h1&gt;Mobile Apps&lt;/h1&gt;
                &lt;form id=&quot;add-item&quot;&gt;
                    &lt;button type=&quot;submit&quot; id=&quot;refresh&quot;&gt;Refresh&lt;/button&gt;
                    &lt;button type=&quot;submit&quot;&gt;Add&lt;/button&gt;
                    &lt;div&gt;
                        &lt;input type=&quot;text&quot; id=&quot;new-item-text&quot; placeholder=&quot;Enter new task&quot;/&gt;
                    &lt;/div&gt;
                &lt;/form&gt;
            &lt;/header&gt;
            &lt;ul id=&quot;todo-items&quot;&gt;&lt;/ul&gt;
            &lt;p id=&quot;summary&quot;&gt;Initializing...&lt;/p&gt;
        &lt;/article&gt;
        &lt;footer&gt;
            &lt;ul id=&quot;errorlog&quot;&gt;&lt;/ul&gt;
        &lt;/footer&gt;
    &lt;/div&gt;
    &lt;script src=&quot;https://code.jquery.com/jquery-2.2.1.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://zumo.blob.core.windows.net/sdk/azure-mobile-apps-client.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;~/Content/spa/jquery/application.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>This will be accessed via the <code>/SPA/JQuery</code> path.  Unlike other (mostly component based) applications,
jQuery uses mark-up extensively, so we are really setting up the basics of the application.  You can
find the CSS on the <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure/blob/master/Chapter6/Backend/Content/spa/jquery/application.css">GitHub repository</a> as its contents are not germane to the discussion here.</p>
<p>The main item to note in the scripts section is the path of the Azure Mobile Apps client.  This is loaded
from the ZUMO CDN.  You can also download the JavaScript file (both minified and non-minified versions exist),
and include it in your <code>Scripts</code> directory if you prefer a local copy.</p>
<p>The <code>~/Content/spa/jquery/application.js</code> file contains our JavaScript code.  It starts with a standard <a href="https://en.wikipedia.org/wiki/Immediately-invoked_function_expression">IIFE</a>
(immediately invoked function expression) - a common method of wrapping code such that variables don't leak into
the global namespace:</p>
<pre><code class="javascript">(function () {
    &quot;use strict&quot;;

    $(onBrowserReady);

    /* Rest of the application */
})();
</code></pre>

<p>The important thing here is that we cannot invoke a client definition until the "DOMContentLoaded" event has fired,
which ensures that all libraries (including those slower libraries loaded from a CDN) have been loaded and executed.
This, in turn, ensures that the <code>WindowsAzure.MobileServiceClient</code> object is available.  The <code>onBrowserReady()</code> function
will be called when this happens:</p>
<pre><code class="javascript">    var client, table;

    /**
     * Event handler, called when the browser has loaded all scripts
     * @event
     */
    function onBrowserReady() {
        // Create a connection reference to our Azure Mobile Apps backend
        client = new WindowsAzure.MobileServiceClient(location.origin);

        // Create a table reference
        table = client.getTable('todoitem');

        // Refresh the todoItems
        refreshDisplay();

        // Wire up the UI event handler for the add item
        $('#add-item').submit(addItemHandler);
        $('#refresh').on('click', refreshDisplay);
    }
</code></pre>

<p>Once the browser is ready for action, we create a <code>MobileServiceClient</code>, get a reference to the table, then wire up the rest
of the UI that we need to handle.  You may notice that the API that the JavaScript SDK for Azure Mobile Apps exposes is very
similar to the .NET SDK.  This is intentional across all the Azure Mobile Apps SDK.  If you know the API surface of one
version, it's likely you can take that knowledge to the other SDKs.  You only have to learn the new programming language.</p>
<h2 id="reading-table-data">Reading Table Data<a class="headerlink" href="#reading-table-data" title="Permanent link">&para;</a></h2>
<p>We can see this more clearly when working with the <code>refreshDisplay()</code> function:</p>
<pre><code class="javascript">    /**
     * Refresh the items within a page
     */
    function refreshDisplay() {
        updateSummaryMessage('Loading data from Azure');

        // Execute a query for uncompleted items and process
        table
            .where({ complete: false })     // Set up the query
            .read()                         // Send query and read results
            .then(createTodoItemList, handleError);
    }

    /**
     * Create the DOM for a single todo item
     * @param {Object} item the Todo item
     * @param {string} item.id the ID of the item
     * @param {bool} item.complete true if the item is complete
     * @param {string} item.text the text value
     * @returns {jQuery} jQuery DOM object
     */
    function createTodoItem(item) {
        return $('&lt;li&gt;')
            .attr('data-todoitem-id', item.id)
            .append($('&lt;button class=&quot;item-delete&quot;&gt;Delete&lt;/button&gt;'))
            .append($('&lt;input type=&quot;checkbox&quot; class=&quot;item-complete&quot;&gt;')
                .prop('checked', item.complete))
            .append($('&lt;div&gt;')
                .append($('&lt;input class=&quot;item-text&quot;&gt;').val(item.text)));
    }

    /**
     * Create a list of Todo Items
     * @param {TodoItem[]} items an array of items
     * @returns {void}
     */
    function createTodoItemList(items) {
        // Cycle through each item received from Azure and add items to the item list
        var listItems = $.map(items, createTodoItem);
        $('#todo-items').empty().append(listItems).toggle(listItems.length &gt; 0);
        updateSummaryMessage('&lt;strong&gt;' + items.length + '&lt;/strong&gt; item(s)');

        // Wire up event handlers
        $('.item-delete').on('click', deleteItemHandler);
        $('.item-text').on('change', updateItemTextHandler);
        $('.item-complete').on('change', updateItemCompleteHandler);
    }
</code></pre>

<p>In the <code>refreshDisplay()</code> function, we can see the parallel with the LINQ language within the .NET world.  JavaScript
does not have a LINQ library, so Azure Mobile Apps provides a simplified version of LINQ (called <a href="https://msdn.microsoft.com/en-us/library/azure/jj613353.aspx">QueryJS</a>) for
use with Azure Mobile Apps.  Once you have set up the appropriate query, calling <code>.read()</code> will actually execute the
HTTP GET to obtain the results.  The other two functions fill in the list of tasks with the appropriate HTML trimmings.</p>
<blockquote>
<p>There is no concept of "offline-sync" in web applications as there is not an equivalent of the SQLite database available.</p>
</blockquote>
<p>You can perform paging with <code>.skip(n)</code> and <code>.take(n)</code>, include the total number of records that would be returned without
paging with <code>.includeTotalCount()</code>, order the returned results and filter by function instead of a specific value.  For
example, let's say you had an orders table and you wanted to produce a paged list of results where the state was OPEN (a
constant) that belonged to a specific user, ordered by their completion date?:</p>
<pre><code class="javascript">function filter (userId, state) {
    return this.owner === userId &amp;&amp; this.state == state;
}

function processResults (results) {
    totalCount = results.totalCount;
    // Handle results here
}

table
    .where(filter, filteredUser, constants.OPEN)
    .orderBy('completionDate')
    .skip(startRecord)
    .take(pageSize)
    .includeTotalCount()
    .read()
    .then(processResults, handleError);
</code></pre>

<p>You can get just the total count using <code>.take(0).includeTotalCount()</code>.</p>
<p>QueryJS is extremely effective at (and optimized for) selecting the exact data you need to do live displays without extra
data being transferred.</p>
<h2 id="modifying-data">Modifying Data<a class="headerlink" href="#modifying-data" title="Permanent link">&para;</a></h2>
<p>In a similar way to the <code>.InsertAsync()</code>, <code>.UpdateAsync()</code> and <code>.DeleteAsync()</code> methods in the .NET SDK, there are methods
for inserting, modifying and deleting data:</p>
<pre><code class="javascript">    /**
     * Given a sub-element of an LI, find the TodoItem ID associated with the list member
     *
     * @param {DOMElement} el the form element
     * @returns {string} the ID of the TodoItem
     */
    function getTodoItemId(el) {
        return $(el).closest('li').attr('data-todoitem-id');
    }

    /**
     * Event handler for when the user enters some text and clicks on Add
     * @param {Event} event the event that caused the request
     * @returns {void}
     */
    function addItemHandler(event) {
        var textbox = $('#new-item-text'),
            itemText = textbox.val();

        updateSummaryMessage('Adding New Item');
        if (itemText !== '') {
            table.insert({
                text: itemText,
                complete: false
            }).then(refreshDisplay, handleError);
        }

        textbox.val('').focus();
        event.preventDefault();
    }

    /**
     * Event handler for when the user clicks on Delete next to a todo item
     * @param {Event} event the event that caused the request
     * @returns {void}
     */
    function deleteItemHandler(event) {
        var itemId = getTodoItemId(event.currentTarget);

        updateSummaryMessage('Deleting Item in Azure');
        table
            .del({ id: itemId })   // Async send the deletion to backend
            .then(refreshDisplay, handleError); // Update the UI
        event.preventDefault();
    }

    /**
     * Event handler for when the user updates the text of a todo item
     * @param {Event} event the event that caused the request
     * @returns {void}
     */
    function updateItemTextHandler(event) {
        var itemId = getTodoItemId(event.currentTarget),
            newText = $(event.currentTarget).val();

        updateSummaryMessage('Updating Item in Azure');
        table
            .update({ id: itemId, text: newText })  // Async send the update to backend
            .then(refreshDisplay, handleError); // Update the UI
        event.preventDefault();
    }

    /**
     * Event handler for when the user updates the completed checkbox of a todo item
     * @param {Event} event the event that caused the request
     * @returns {void}
     */
    function updateItemCompleteHandler(event) {
        var itemId = getTodoItemId(event.currentTarget),
            isComplete = $(event.currentTarget).prop('checked');

        updateSummaryMessage('Updating Item in Azure');
        table
            .update({ id: itemId, complete: isComplete })  // Async send the update to backend
            .then(refreshDisplay, handleError);        // Update the UI
    }
</code></pre>

<p>We insert data by passing the object to insert to <code>table.insert()</code>, modify with <code>table.update()</code>
and delete with <code>table.del()</code>.  These functions all operate using promises.  Once the promise
returns, we call the <code>refreshDisplay()</code> method to refresh the data.  In the case of the <code>.insert()</code>
and <code>.update()</code> functions, the promise is called with the updated item (containing the extra fields
that the server adds), allowing the code to update a cache if necessary and avoiding a round-trip for
the search.</p>
<!-- Links -->
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../mvc/" title="MVC Applications">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                MVC Applications
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../angular/" title="Angular Applications">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Angular Applications
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = 'adrianhall/develop-mobile-apps-with-csharp-and-azure';
    </script>
    <script src="../../assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="../../js/highlight.pack.js"></script>
    
    
  </body>
</html>