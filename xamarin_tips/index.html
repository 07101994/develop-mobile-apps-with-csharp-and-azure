<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Xamarin Forms Tips - Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure</title>
      
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure">
    <meta property="og:image" content="None/../">
    <meta name="apple-mobile-web-app-title" content="Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../assets/fonts/icon.eot?52m981');
      	src: url('../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../assets/stylesheets/application-a422ff04cc.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script src="../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class=" ">
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
          </span>
        
        Xamarin Forms Tips
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="/" class="project">
    <div class="banner">
      
      <div class="name">
        <strong>
          Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure
          <span class="version">
            
          </span>
        </strong>
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Getting Started" href="..">
      Getting Started
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Chapter 1 - Introduction</span>
    <ul>
      
        
  <li>
    <a class="" title="Your First App - PC Edition" href="../chapter1/firstapp_pc/">
      Your First App - PC Edition
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Your First App - Mac Edition" href="../chapter1/firstapp_mac/">
      Your First App - Mac Edition
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Chapter 2 - Authentication</span>
    <ul>
      
        
  <li>
    <a class="" title="Concepts" href="../chapter2/concepts/">
      Concepts
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Authentication in the Backend" href="../chapter2/backend/">
      Authentication in the Backend
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Enterprise Authentication" href="../chapter2/enterprise/">
      Enterprise Authentication
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Social Authentication" href="../chapter2/social/">
      Social Authentication
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Debugging Authentication" href="../chapter2/debugging/">
      Debugging Authentication
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Custom Authentication" href="../chapter2/custom/">
      Custom Authentication
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Claims and Authorization" href="../chapter2/authorization/">
      Claims and Authorization
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Tokens in Real Apps" href="../chapter2/realworld/">
      Tokens in Real Apps
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Best Practices" href="../chapter2/bestpractices/">
      Best Practices
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="Data Access and Offline Sync" href="../data/">
      Data Access and Offline Sync
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Authenticated Data Access" href="../authdata/">
      Authenticated Data Access
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="File Management" href="../files/">
      File Management
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Push Notifications" href="../push/">
      Push Notifications
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Server Side Code" href="../custom/">
      Server Side Code
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Media Services" href="../media/">
      Media Services
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Leveraging Search" href="../search/">
      Leveraging Search
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Web and Mobile Apps" href="../combined/">
      Web and Mobile Apps
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="The Development Environment" href="../developing/">
      The Development Environment
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Testing your Application" href="../testing/">
      Testing your Application
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Troubleshooting" href="../troubleshooting/">
      Troubleshooting
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Going to Production" href="../production/">
      Going to Production
    </a>
    
  </li>

          
            
  <li>
    <a class="current" title="Xamarin Forms Tips" href="./">
      Xamarin Forms Tips
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Improve your ListView performance" href="#improve-your-listview-performance">
                Improve your ListView performance
              </a>
            </li>
          
            <li class="anchor">
              <a title="Building a Floating Action Button" href="#building-a-floating-action-button">
                Building a Floating Action Button
              </a>
            </li>
          
            <li class="anchor">
              <a title="Installing NuGet Packages in Multiple Projects" href="#installing-nuget-packages-in-multiple-projects">
                Installing NuGet Packages in Multiple Projects
              </a>
            </li>
          
            <li class="anchor">
              <a title="Auto-Deploy Universal Windows Apps" href="#auto-deploy-universal-windows-apps">
                Auto-Deploy Universal Windows Apps
              </a>
            </li>
          
        </ul>
      
    
  </li>

          
            
  <li>
    <a class="" title="Android Developer Notes" href="../android_appendix/">
      Android Developer Notes
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="References" href="../references/">
      References
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="Credits" href="../credits/">
      Credits
    </a>
    
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="xamarin-forms-tips">Xamarin Forms Tips<a class="headerlink" href="#xamarin-forms-tips" title="Permanent link">&para;</a></h1>
<p>Over the many months I have spent coding Xamarin Forms, a number of people
from the community and the Xamarin team have given me little tips to improve
my Xamarin Forms code.  I hope you find them as useful as I did.</p>
<h2 id="improve-your-listview-performance">Improve your ListView performance<a class="headerlink" href="#improve-your-listview-performance" title="Permanent link">&para;</a></h2>
<p>It should be no surprise that performance matters.  Little things like smooth
scrolling and fast load times are a must.  A lot of improvement can be gained
by the techniques we have shown in this book since most of the perceived delays
are caused by the back end loading times.</p>
<p>Eventually, a lot of apps generate a list.  The normal way for implementing
this is with a <code>ListView</code> that has an <code>ObservableCollection</code>  You load your
data into the ObservableCollection and then update that whenever the data
changes.  That, in turn, updates the ListView.</p>
<p>There are two problems that are inherent here.  The first is in the ObservableCollection
and the second is in the ListView.  Let's tackle the ObservableCollection first.</p>
<p>The problem with the ObservableCollection is that it's very hard to update.
What normally ends up happening is code like this:</p>
<pre><code class="csharp">// Earlier in the code
var listContents = new ObservableCollection&lt;Model&gt;();

// When updating the code
var items = await table.ReadAllItemsAsync();
listContents.Clear();
for (var item in items) {
    listContents.Add(item);
}
</code></pre>

<p>The point of the ObservableCollection is that it emits an event whenever the
list changes.  In the case where the table has thousands of entries, thousands
of events will cause thousands of redraws, causing a major slow down in your
code that you probably won't know until you have a large enough data set to
note the problem.</p>
<p>Fortunately, one of the top Xamarin Evangelists, <a href="https://github.com/jamesmontemagno">James Montemagno</a>, has
created a set of helper classes that assist with this sort of problem.  The
solution to this problem is to use the <a href="https://github.com/jamesmontemagno/mvvm-helpers/blob/35f0ddd7e739eb5daed3c90cae1334d3e674229b/MvvmHelpers/ObservableRangeCollection.cs">ObservableRangeCollection</a>, like
this:</p>
<pre><code class="csharp">// Earlier in the code
var listContents = new ObservableRangeCollection&lt;Model&gt;();

// When updating the code
var items = await table.ReadAllItemsAsync();
listContents.ReplaceRange(items);
</code></pre>

<p>With this code, Xamarin Forms gets notified once instead of thousands of times.
There are actually several versions of this same behavior in the NuGet repository.</p>
<p>As to the second problem.  A <code>ListView</code> with thousands of items will not be
showing all the items at once.  A ListView will update all the items that have
been updated, irrespective of whether they are visible or not.  The answer is
to use a caching strategy.  There are two potential caching strategies.  with
<code>RetainElement</code>, the ListView will generate a cell for each item in the list.
This is the default, but it's really only good for certain situations (most
notably when the cell has a large number of bindings).  For almost all situations,
the <code>RecycleElement</code> caching strategy should be used.  In this caching strategy,
the ListView will minimize the memory foot print and execution speed by only
updating cells when they are in the viewable area.  This is good pretty much
all the time, but explicitly when the cell has a small number of bindings or
when each cell in the list has the same template.  All data about the cell must
come from the binding context when using the <code>RecycleElement</code> caching strategy.</p>
<p>You can set the caching strategy right in the XAML:</p>
<pre><code class="xml">&lt;ListView CachingStrategy=&quot;RecycleElement&quot; ...&gt;
</code></pre>

<p>Alternatively, if you are creating a ListView in code, you can specify the
caching strategy in the constructor:</p>
<pre><code class="csharp">var listView = new ListView(ListViewCachingStrategy.RecycleElement);
</code></pre>

<p>There are more techniques for improving ListView performance in the
<a href="https://developer.xamarin.com/guides/xamarin-forms/user-interface/listview/performance/">Xamarin documentation</a></p>
<h2 id="building-a-floating-action-button">Building a Floating Action Button<a class="headerlink" href="#building-a-floating-action-button" title="Permanent link">&para;</a></h2>
<p>One of the things that I wanted to do to my apps was to give them a little more in the
way of normal UI design.  My original design (which I introduced back in [Chapter ][ch1])
had teal buttons at the bottom of the page.  These buttons scrolled off the page when
there were more items on the page than could reasonably be fit on the page.  To fix this,
I wanted to create a button that was always relative to the viewport.</p>
<p>There are two steps to this.  Firstly, you need to convert the layout to a <code>RelativeLayout</code>.
For instance, my new <code>ListView.xaml</code> file:</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;
&lt;ContentPage x:Class=&quot;TaskList.Pages.TaskList&quot;
             xmlns=&quot;http://xamarin.com/schemas/2014/forms&quot;
             xmlns:x=&quot;http://schemas.microsoft.com/winfx/2009/xaml&quot;
             Title=&quot;{Binding Title}&quot;&gt;
    &lt;ContentPage.Content&gt;
        &lt;RelativeLayout&gt;
            &lt;StackLayout RelativeLayout.HeightConstraint=&quot;{ConstraintExpression Type=RelativeToParent, Property=Height, Factor=1}&quot;
                         RelativeLayout.WidthConstraint=&quot;{ConstraintExpression Type=RelativeToParent, Property=Width, Factor=1}&quot;&gt;
</code></pre>

<p>The original <code>StackLayout</code> layout renderer is placed inside the newly added <code>RelativeLayout</code>.
The height and width constraints tell the StackLayout to consume the whole screen.</p>
<p>At the bottom of the page, I can add my button:</p>
<pre><code class="xml">            &lt;/StackLayout&gt;

            &lt;!--  The Floating Button  --&gt;
            &lt;Button BackgroundColor=&quot;Teal&quot;
                    Command=&quot;{Binding AddNewItemCommand}&quot;
                    RelativeLayout.XConstraint=&quot;{ConstraintExpression Type=RelativeToParent,
                                                                      Property=Width,
                                                                      Factor=1,
                                                                      Constant=-60}&quot;
                    RelativeLayout.YConstraint=&quot;{ConstraintExpression Type=RelativeToParent,
                                                                      Property=Height,
                                                                      Factor=1,
                                                                      Constant=-60}&quot;
                    Text=&quot;+&quot;
                    TextColor=&quot;White&quot; /&gt;
        &lt;/RelativeLayout&gt;
    &lt;/ContentPage.Content&gt;
&lt;/ContentPage&gt;
</code></pre>

<p>The <code>StackLayout</code> is the end of the StackLayout I introduced in the previous listing.  Now
I can add a button (or any other View type control, including a custom control that I may
have downloaded from NuGet or the Xamarin Plugins site) as well.  The button will float
above the other content since it is added later.  The constraints in this case provide
the location of the button.</p>
<p>There is more work to do.  For instance, you cannot click on the thing behind the button -
the button always receives the click, which will (in this case) initiate the addition of
a new item.  A custom control will allow you to provide iconography for the button, handle
situations where you want to scroll behind and provide for the circular styling of the button
which seems to be in-vogue right now.</p>
<p>If you want to place commands that are not normally used, you may want to consider the ToolbarItem
area of the ContentPage.  Here is a snippet:</p>
<pre><code class="xml">    &lt;ContentPage.ToolbarItems&gt;
        &lt;ToolbarItem Name=&quot;Refresh&quot;
                     Command=&quot;{Binding RefreshCommand}&quot;
                     Icon=&quot;refresh.png&quot;
                     Order=&quot;Primary&quot;
                     Priority=&quot;0&quot; /&gt;
    &lt;/ContentPage.ToolbarItems&gt;
</code></pre>

<p>On Universal Windows (where this is actually important due to a lack of "pull-to-refresh" logic), you
will see the familiar triple-dot on the app bar - clicking on the triple dot gives you access to
the refresh command.</p>
<h2 id="installing-nuget-packages-in-multiple-projects">Installing NuGet Packages in Multiple Projects<a class="headerlink" href="#installing-nuget-packages-in-multiple-projects" title="Permanent link">&para;</a></h2>
<p>One of the common requirements we have in Xamarin Forms is to install NuGet packages
in all the Xamarin Forms projects.  To do this, right-click on the solution and select
<strong>Manage NuGet Packages for Solution...</strong>.  When you install a package here, you can
select which projects it should be applied to, allowing you to install a package once
across all the dependent projects.</p>
<h2 id="auto-deploy-universal-windows-apps">Auto-Deploy Universal Windows Apps<a class="headerlink" href="#auto-deploy-universal-windows-apps" title="Permanent link">&para;</a></h2>
<p>One of the more annoying things is that you have to <strong>Deploy</strong> the Universal Windows app.
This gets in the way of the build process.  I like to build then run.  Having the extra
Deploy step in there might not seem like much until you find yourself deploying several
times an hour.</p>
<p>Fortunately, there is a simple fix for this.  Set up the <strong>Configuration Manager</strong> to
automatically deploy the right libraries on every successful build.  To do this:</p>
<ul>
<li>In Visual Studio, select <strong>Build</strong> -&gt; <strong>Configuration Manager...</strong></li>
<li>Check the boxes you can under <strong>Deploy</strong></li>
</ul>
<p><img alt="Visual Studio Configuration Manager" src="../img/tips/vs-config-mgr.PNG" /></p>
<ul>
<li>Click on <strong>Close</strong></li>
</ul>
<p>This setting is saved within the solution, so you only need to do it once per project.</p>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../production/" title="Going to Production">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Going to Production
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../android_appendix/" title="Android Developer Notes">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Android Developer Notes
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '..';
      var repo_id  = '';
    </script>
    <script src="../assets/javascripts/application-997097ee0c.js"></script>
    
    
  </body>
</html>