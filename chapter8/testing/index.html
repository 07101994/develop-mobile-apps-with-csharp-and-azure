
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://adrianhall.github.io/develop-mobile-apps-with-csharp-and-azure/chapter8/testing/">
      
      
        <meta name="author" content="Adrian Hall">
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.1, mkdocs-material-1.2.0">
    
    
      
        <title>Testing your Application - Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-56ade86843.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-e17eeafcbc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-892b79c5c5.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/vs.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="red" data-md-color-accent="deep-purple">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../.." title="Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure" class="md-icon md-icon--home md-header-nav__button">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Chapter 8 - Developing An App
                </span>
              
            
            Testing your Application
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result"></div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
            


  


  <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-icon md-icon--home md-nav__button"></i>
    
    Develop Cloud Connected Mobile Apps with Xamarin and Microsoft Azure
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Chapter 1 - Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Chapter 1 - Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter1/firstapp_pc/" title="Your First App - PC Edition" class="md-nav__link">
      Your First App - PC Edition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter1/firstapp_mac/" title="Your First App - Mac Edition" class="md-nav__link">
      Your First App - Mac Edition
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Chapter 2 - Authentication
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Chapter 2 - Authentication
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/authconcepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/backend/" title="Authentication in the Backend" class="md-nav__link">
      Authentication in the Backend
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/enterprise/" title="Enterprise Authentication" class="md-nav__link">
      Enterprise Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/social/" title="Social Authentication" class="md-nav__link">
      Social Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/debugging/" title="Debugging Authentication" class="md-nav__link">
      Debugging Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/custom/" title="Custom Authentication" class="md-nav__link">
      Custom Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/authorization/" title="Claims and Authorization" class="md-nav__link">
      Claims and Authorization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/realworld/" title="Tokens in Real Apps" class="md-nav__link">
      Tokens in Real Apps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter2/bestpractices/" title="Best Practices" class="md-nav__link">
      Best Practices
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Chapter 3 - Data Access and Offline Sync
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Chapter 3 - Data Access and Offline Sync
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/dataconcepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/server/" title="Implementing Table Controllers" class="md-nav__link">
      Implementing Table Controllers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/projection/" title="Data Projection and Queries" class="md-nav__link">
      Data Projection and Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/client/" title="The Mobile Client" class="md-nav__link">
      The Mobile Client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/relationships/" title="Relationships" class="md-nav__link">
      Relationships
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter3/domainmgr/" title="The Domain Manager" class="md-nav__link">
      The Domain Manager
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Chapter 4 - Server Side Code
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Chapter 4 - Server Side Code
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter4/options/" title="Options for Server Code" class="md-nav__link">
      Options for Server Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter4/custom/" title="Custom HTTP Endpoints" class="md-nav__link">
      Custom HTTP Endpoints
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter4/webjobs/" title="WebJobs" class="md-nav__link">
      WebJobs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter4/functions/" title="Functions" class="md-nav__link">
      Functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter4/recipes/" title="Recipes" class="md-nav__link">
      Recipes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Chapter 5 - Push Notifications
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Chapter 5 - Push Notifications
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter5/concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter5/android/" title="Android Push" class="md-nav__link">
      Android Push
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter5/ios/" title="iOS Push" class="md-nav__link">
      iOS Push
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter5/windows/" title="Windows Push" class="md-nav__link">
      Windows Push
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter5/recipes/" title="Push Recipes" class="md-nav__link">
      Push Recipes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Chapter 6 - Combining Web and Mobile Apps
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Chapter 6 - Combining Web and Mobile Apps
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter6/mvc/" title="MVC Applications" class="md-nav__link">
      MVC Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter6/jquery/" title="jQuery Applications" class="md-nav__link">
      jQuery Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter6/angular/" title="Angular Applications" class="md-nav__link">
      Angular Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter6/react/" title="React Applications" class="md-nav__link">
      React Applications
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Chapter 7 - Other Useful Services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Chapter 7 - Other Useful Services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter7/services/" title="Useful Azure Services" class="md-nav__link">
      Useful Azure Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter7/search/" title="Azure Search" class="md-nav__link">
      Azure Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter7/media/" title="Media Services" class="md-nav__link">
      Media Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter7/realtime/" title="Real-time Notifications" class="md-nav__link">
      Real-time Notifications
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      Chapter 8 - Developing An App
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Chapter 8 - Developing An App
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../developing/" title="The Development Environment" class="md-nav__link">
      The Development Environment
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Testing your Application
      </label>
    
    <a href="./" title="Testing your Application" class="md-nav__link md-nav__link--active">
      Testing your Application
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#testing-your-mobile-backend" title="Testing your Mobile Backend" class="md-nav__link">
    Testing your Mobile Backend
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unit-testing" title="Unit Testing" class="md-nav__link">
    Unit Testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-your-mobile-client" title="Testing your Mobile Client" class="md-nav__link">
    Testing your Mobile Client
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-mock-data-services" title="Using Mock Data Services" class="md-nav__link">
    Using Mock Data Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unit-testing_1" title="Unit Testing" class="md-nav__link">
    Unit Testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#end-to-end-testing" title="End to End Testing" class="md-nav__link">
    End to End Testing
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction-to-xamarin-test-cloud" title="Introduction to Xamarin Test Cloud" class="md-nav__link">
    Introduction to Xamarin Test Cloud
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Chapter 9 - Going to Production
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Chapter 9 - Going to Production
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter9/arm/" title="Repeatable Deployments" class="md-nav__link">
      Repeatable Deployments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter9/appsvc/" title="Safe Deployments" class="md-nav__link">
      Safe Deployments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter9/monitoring/" title="Monitoring" class="md-nav__link">
      Monitoring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../chapter9/troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../xamarin_tips/" title="Xamarin Forms Tips" class="md-nav__link">
      Xamarin Forms Tips
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../android_appendix/" title="Android Developer Notes" class="md-nav__link">
      Android Developer Notes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../vs_extensions/" title="Visual Studio Extensions" class="md-nav__link">
      Visual Studio Extensions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../references/" title="References" class="md-nav__link">
      References
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../credits/" title="Credits" class="md-nav__link">
      Credits
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#testing-your-mobile-backend" title="Testing your Mobile Backend" class="md-nav__link">
    Testing your Mobile Backend
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unit-testing" title="Unit Testing" class="md-nav__link">
    Unit Testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-your-mobile-client" title="Testing your Mobile Client" class="md-nav__link">
    Testing your Mobile Client
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-mock-data-services" title="Using Mock Data Services" class="md-nav__link">
    Using Mock Data Services
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unit-testing_1" title="Unit Testing" class="md-nav__link">
    Unit Testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#end-to-end-testing" title="End to End Testing" class="md-nav__link">
    End to End Testing
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction-to-xamarin-test-cloud" title="Introduction to Xamarin Test Cloud" class="md-nav__link">
    Introduction to Xamarin Test Cloud
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
               
                 <a href="https://github.com/adrianhall/develop-mobile-apps-with-csharp-and-azure/edit/master/docs/chapter8\testing.md" title="Edit this page" class="md-icon md-content__edit">edit</a>
               
              
                
                <h1 id="testing-your-mobile-application">Testing your Mobile Application<a class="headerlink" href="#testing-your-mobile-application" title="Permanent link">&para;</a></h1>
<p>There is nothing that causes more problems than when a developer works on testing.  Testing a cross-platform client-server application across all the permutations that are possible is hard work.  You will spend more time on developing tests than on writing code.  Much of what is asked, however, is not required.  That is primarily because most people want to test the entire stack.  There are generally minimal custom code in the backend, so that can significantly reduce the amount of tests you write.</p>
<p>In this section, we will look at what it takes to do unit tests for your mobile backend and the mobile app, together with an end-to-end testing capability that allows you to test your application on many devices at once.</p>
<h2 id="testing-your-mobile-backend">Testing your Mobile Backend<a class="headerlink" href="#testing-your-mobile-backend" title="Permanent link">&para;</a></h2>
<p>Most of the code within the mobile backend is pulled from libraries - ASP.NET, Entity Framework and Azure Mobile Apps.  These libraries are already tested before release and there is not much you can do about bugs other than reporting them (although Azure Mobile Apps does accept fixes as well).  As a result, you should concentrate your testing on the following areas:</p>
<ul>
<li>Filters, Transforms and Actions associated with your table controllers.</li>
<li>Custom APIs.</li>
</ul>
<p>Later, we will cover End to End Testing scenarios, where you will test the client in combination with your server.  This is when the actual server is exercised fully by your client and is a much better test of the overall functionality of your server.</p>
<p>In addition, your mobile backend will come under a lot of strain after you go to production.  You should plan on a load test prior to each major release in a staging environment that is identical to your production environment.  We'll cover this later in the book.</p>
<h3 id="unit-testing">Unit Testing<a class="headerlink" href="#unit-testing" title="Permanent link">&para;</a></h3>
<p>Let's take a simple example of an app that we developed back in Chapter 3.  We used the data connections to develop a personal todo store - one in which the users ID is associated with each submitted record and the user could only see their own records.  The table controller looked like the following:</p>
<pre><code class="csharp">namespace Backend.Controllers
{
    public class TodoItemController : TableController&lt;TodoItem&gt;
    {
        protected override void Initialize(HttpControllerContext controllerContext)
        {
            base.Initialize(controllerContext);
            MobileServiceContext context = new MobileServiceContext();
            DomainManager = new EntityDomainManager&lt;TodoItem&gt;(context, Request, enableSoftDelete: true);
        }

        public string UserId =&gt; ((ClaimsPrincipal)User).FindFirst(ClaimTypes.NameIdentifier).Value;

        public void ValidateOwner(string id)
        {
            var result = Lookup(id).Queryable.PerUserFilter(UserId).FirstOrDefault&lt;TodoItem&gt;();
            if (result == null)
            {
                throw new HttpResponseException(HttpStatusCode.NotFound);
            }
        }

        // GET tables/TodoItem
        public IQueryable&lt;TodoItem&gt; GetAllTodoItems()
        {
            return Query().PerUserFilter(UserId);
        }

        // GET tables/TodoItem/48D68C86-6EA6-4C25-AA33-223FC9A27959
        public SingleResult&lt;TodoItem&gt; GetTodoItem(string id)
        {
            return new SingleResult&lt;TodoItem&gt;(Lookup(id).Queryable.PerUserFilter(UserId));
        }

        // PATCH tables/TodoItem/48D68C86-6EA6-4C25-AA33-223FC9A27959
        public Task&lt;TodoItem&gt; PatchTodoItem(string id, Delta&lt;TodoItem&gt; patch)
        {
            ValidateOwner(id);
            return UpdateAsync(id, patch);
        }

        // POST tables/TodoItem
        public async Task&lt;IHttpActionResult&gt; PostTodoItem(TodoItem item)
        {
            item.UserId = UserId;
            TodoItem current = await InsertAsync(item);
            return CreatedAtRoute(&quot;Tables&quot;, new { id = current.Id }, current);
        }

        // DELETE tables/TodoItem/48D68C86-6EA6-4C25-AA33-223FC9A27959
        public Task DeleteTodoItem(string id)
        {
            ValidateOwner(id);
            return DeleteAsync(id);
        }
    }
}
</code></pre>

<p>In addition, we have a LINQ extension method for handling the <code>PerUserFilter</code>:</p>
<pre><code class="csharp">using Backend.DataObjects;
using System.Linq;

namespace Backend.Extensions
{
    public static class PerUserFilterExtension
    {
        public static IQueryable&lt;TodoItem&gt; PerUserFilter(this IQueryable&lt;TodoItem&gt; query, string userid)
        {
            return query.Where(item =&gt; item.UserId.Equals(userid));

        }
    }
}
</code></pre>

<p>In my minimalist testing suggestion, I would test the following:</p>
<ul>
<li>The LINQ Extension <code>PerUserFilter</code>.</li>
<li>The <code>UserId</code> property.</li>
<li>The <code>ValidateOwner</code> method.</li>
</ul>
<p>The other methods are straight out of the standard table controller.  I would defer unit testing of these until the end-to-end tests.  Unit tests should be short and should be idempotent.  The test should be able to be run multiple times and always return the same result.  Since our service is defined to be run out of a stateful SQL database, it cannot be defined to be idempotent.  However, the individual parts we are operating can be idempotent.</p>
<p>Unit tests are generally defined to be a separate project within the Visual Studio solution.  By convention, they are named by appending <code>.Tests</code> to the project they are testing.  My project is called <code>Backend</code>, so the test project is called <code>Backend.Tests</code>.  To create the test project:</p>
<ul>
<li>Open the solution in Visual Studio.</li>
<li>Right-click the solution, choose <strong>Add</strong> -&gt; <strong>New Project...</strong>.</li>
<li>Select <strong>Installed</strong> &gt; <strong>Visual C#</strong> &gt; <strong>Test</strong> in the project type tree.</li>
<li>Select <strong>xUnit Test Project</strong> as the project type.</li>
<li>Enter <strong>Backend.Tests</strong> as the name, then click <strong>OK</strong>. </li>
</ul>
<div class="admonition info">
<p class="admonition-title">xUnit vs. MSTest vs. Others</p>
<p>Most version of Visual Studio support a specific type of test called <a href="https://msdn.microsoft.com/en-us/library/hh694602.aspx">MSTest</a>.  However, Visual Studio 2017 has integrated <a href="https://xunit.github.io/">xUnit</a> testing as well.  xUnit is cross-platform whereas MSTest is PC only.  I will be using xUnit for this project.  If you are using a version of Visual Studio earlier than VS2017, you will not have the xUnit Test Project available.  However, you can <a href="http://xunit.github.io/docs/getting-started-desktop.html">simulate the same project type manually</a>.  In addition, there are <a href="https://github.com/dariusz-wozniak/List-of-Testing-Tools-and-Frameworks-for-.NET/blob/master/README.md">other test frameworks</a> available.  We will only be covering xUnit here.</p>
</div>
<p>Generally, copy the folder format from the main project to the test project.  For example, the <code>PerUserFilterExtension.cs</code> file is in an <code>Extensions</code> folder within the main project.  I'm going to create an <code>Extensions</code> folder within the test project and create a <code>PerUserFilterExtensionTests.cs</code> file with the tests in it.  To create the tests:</p>
<ul>
<li>Right-click the <code>Extensions</code> folder, and select <strong>Add</strong> -&gt; <strong>New Item...</strong>.</li>
<li>Select <strong>Installed</strong> &gt; <strong>Visual C# Items</strong> &gt; <strong>Test</strong> in the project type tree.</li>
<li>Select <strong>xUnit Test</strong>, and enter <code>PerUserFilterExtensionTests.cs</code> as the name.</li>
<li>Click <strong>Add</strong>.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Add your Project under Test as a Reference</p>
<p>You will need to add your project under test (in this case, the <code>Backend</code> project) as a reference to the test project.</p>
</div>
<p>You will get this code generated:</p>
<pre><code class="csharp">using System;
using System.Linq;
using Xunit;

namespace Backend.Tests.Extensions
{
    public class PerUserFilterExtensionTests
    {
        [Fact]
        public void TestMethod1()
        {
        }
    }
}
</code></pre>

<p>We are going to replace the <code>TestMethod1()</code> method with our unit tests.  XUnit tests are designated with the <code>[Fact]</code> attribute.  You do some work on the class to test specific conditions, then assert that the results are valid.  In the case of this class, for instance, we want to test that the result is correct under the following conditions:</p>
<ul>
<li>A valid string is provided.</li>
<li>A zero-length string is provided.</li>
<li>Null is provided.</li>
</ul>
<p>Under no conditions should the extension method throw an exception.  That means three tests, coded thusly:</p>
<pre><code class="csharp">using Backend.DataObjects;
using Backend.Extensions;
using System;
using System.Collections.Generic;
using System.Linq;
using Xunit;

namespace Backend.Tests.Extensions
{
    public class PerUserFilterExtensionTests
    {
        [Fact]
        public void UserId_Is_Valid()
        {
            List&lt;TodoItem&gt; items = new List&lt;TodoItem&gt;
            {
                new TodoItem { UserId = &quot;test&quot;, Text = &quot;Task 1&quot;, Complete = false },
                new TodoItem { UserId = &quot;test2&quot;, Text = &quot;Task 2&quot;, Complete = true },
                new TodoItem { UserId = &quot;test&quot;, Text = &quot;Task 3&quot;, Complete = false }
            };

            var result = items.AsQueryable&lt;TodoItem&gt;().PerUserFilter(&quot;test&quot;);

            Assert.NotNull(result);
            Assert.Equal(2, result.Count());
        }

        [Fact]
        public void UserId_Is_Empty()
        {
            List&lt;TodoItem&gt; items = new List&lt;TodoItem&gt;
            {
                new TodoItem { UserId = &quot;test&quot;, Text = &quot;Task 1&quot;, Complete = false },
                new TodoItem { UserId = &quot;test2&quot;, Text = &quot;Task 2&quot;, Complete = true },
                new TodoItem { UserId = &quot;test&quot;, Text = &quot;Task 3&quot;, Complete = false }
            };

            var result = items.AsQueryable&lt;TodoItem&gt;().PerUserFilter(String.Empty);

            Assert.NotNull(result);
            Assert.Equal(0, result.Count());
        }

        [Fact]
        public void UserId_Is_Null()
        {
            List&lt;TodoItem&gt; items = new List&lt;TodoItem&gt;
            {
                new TodoItem { UserId = &quot;test&quot;, Text = &quot;Task 1&quot;, Complete = false },
                new TodoItem { UserId = &quot;test2&quot;, Text = &quot;Task 2&quot;, Complete = true },
                new TodoItem { UserId = &quot;test&quot;, Text = &quot;Task 3&quot;, Complete = false }
            };

            var result = items.AsQueryable&lt;TodoItem&gt;().PerUserFilter(null);

            Assert.NotNull(result);
            Assert.Equal(0, result.Count());
        }
    }
}
</code></pre>

<div class="admonition tip">
<p class="admonition-title">Use the same .NET Framework Version</p>
<p>You will note that your tests will not compile at this point.  That is because the server is dependent on .NET Framework 4.6 and the test project is created with .NET Framework 4.5.  Both test and main project must be configured to use the same version of the .NET Framework.  Right-click the test project, select <strong>Properties</strong>, then change the version of the .NET Framework to match your main project.  Save and re-build your test project.</p>
</div>
<p>Visual Studio has a couple of methods of running the tests.  Visual Studio 2017 has in-built support for the xUnit test runner.  You may have to download an extension or run them manually in earlier versions of Visual Studio.  My favorite way of running the tests is to open the Test Explorer using <strong>Test</strong> -&gt; <strong>Windows</strong> -&gt; <strong>Test Explorer</strong>, then click <strong>Run All</strong>.  You can then right-click the Test Explorer tab and select <strong>Float</strong> to float it as a window.  This allows you to enlarge the window so you can see the tests after they have run:</p>
<p><img alt="" src="../img/test-explorer.PNG" /></p>
<p>As you can see, my tests all passed.  I can run these tests as many times as necessary as they do not depend on external requirements.  This is not generally the case with table controllers.  The table controller takes a dependency on a domain manager (most normally, the <code>EntityDomainManager</code>).  The <code>EntityDomainManager</code> is configured to use a database via a connection string.  Thus, we need to do things differently for testing table controllers even if we only test the unique functionality.  </p>
<p>Let's take a look at the tests for the <code>UserId</code> property.  The <code>UserId</code> property contains the contents of the <code>NameIdentifier</code> claim.  My tests for this are:</p>
<ul>
<li>A correct set of claims are provided.</li>
<li>An incomplete set of claims (without a NameIdentifier) are provided.</li>
<li>No claims are provided.</li>
</ul>
<p>The first and last are the typical authenticated and anonymous access tests.  The first should provide the username in the NameIdentifier, and the latter should throw an error.  The middle test is an important one for us.  What do you want to happen if the user is authenticated, but the NameIdentifier claim was not provided?  It's bad form for us to return a 500 Internal Server Error, even though that would be appropriate here.  Instead I want to assume that the user id is blank so that everything keeps on working.  (One can argue that this is not correct either!)</p>
<div class="admonition tip">
<p class="admonition-title">Install the same NuGet packages</p>
<p>Unlike the scaffolded project for Azure Mobile Apps or ASP.NET MVC, no additional packages are added to the test project, which means you will need to figure out which packages you need to simulate the requirements for the test.  Don't guess.  Look at the packages that are in your project under test and duplicate them.  Right-click the solution and select <strong>Manage NuGet Packages</strong> to get a good idea of what your test package is missing.  Under the <strong>Installed</strong> list, you can tell what packages are required and which projects have them installed.</p>
</div>
<p>To test authentication, I need to mock the <code>ClaimsIdentity</code>.  I put this in a utility class:</p>
<pre><code class="csharp">using System.Security.Claims;

namespace Backend.Tests.Utilities
{
    public class TestPrincipal : ClaimsPrincipal
    {
        public TestPrincipal(params Claim[] claims) : base(new TestIdentity(claims))
        {
        }
    }

    public class TestIdentity : ClaimsIdentity
    {
        public TestIdentity(params Claim[] claims) : base(claims)
        {
        }
    }
}
</code></pre>

<p>My (incorrect - deliberately) test looks like the following:</p>
<pre><code class="csharp">using Backend.Controllers;
using Backend.Tests.Utilities;
using System.Security.Claims;
using System.Threading;
using Xunit;

namespace Backend.Tests.Controllers
{
    public class TodoItemControllerTests
    {
        [Fact]
        public void UserId_With_Correct_Claims()
        {
            var controller = new TodoItemController();
            controller.User = new TestPrincipal(
                new Claim(&quot;name&quot;, &quot;testuser&quot;),
                new Claim(&quot;sub&quot;, &quot;foo&quot;)
            );
            var result = controller.UserId;

            Assert.NotNull(result);
            Assert.Equal(&quot;testuser&quot;, result);
        }

        [Fact]
        public void UserId_With_Incomplete_Claims()
        {
            var controller = new TodoItemController();
            controller.User = new TestPrincipal(
                new Claim(&quot;sub&quot;, &quot;foo&quot;)
            );
            var result = controller.UserId;

            Assert.Null(result);
        }

        [Fact]
        public void UserId_With_Null_Claims()
        {
            var controller = new TodoItemController();
            controller.User = null;
            var ex = Assert.Throws&lt;HttpResponseException&gt;(() =&gt; { var result = controller.UserId; });
            Assert.Equal(HttpStatusCode.Unauthorized, ex.Response.StatusCode);
        }
    }
}
</code></pre>

<p>The <code>UserId_With_Null_Claims</code> test is an interesting recipe for testing that the right exception is thrown.  In this case, I expect the methods to return a 401 Unauthorized response to the client.  Of course, the <code>[Authorize]</code> tag will do this for my well before my code is hit, but it's good to be accurate.</p>
<p>If I run the tests, I get the following:</p>
<p><img alt="" src="../img/failed-tests.PNG" /></p>
<p>What I want to do is run that test again, but attach a debugger.  To do this, set a breakpoint on the property in the <code>TodoItemController</code>.  Then right-click the failing test and select <strong>Debug Selected Tests</strong>.  This runs the test with a debugger connected.  The breakpoint you set will be hit and you will be able to inspect the code state while it is running.  The first test is failing because <code>ClaimTypes.NameIdentifier</code> is not "name".  I re-wrote the test as follows:</p>
<pre><code class="csharp">    [Fact]
    public void UserId_With_Correct_Claims()
    {
        var controller = new TodoItemController();
        controller.User = new TestPrincipal(
            new Claim(ClaimTypes.NameIdentifier, &quot;testuser&quot;),
            new Claim(&quot;sub&quot;, &quot;foo&quot;)
        );
        var result = controller.UserId;

        Assert.NotNull(result);
        Assert.Equal(&quot;testuser&quot;, result);
    }
</code></pre>

<p>This test will now pass.  The other two tests are actually the result of incorrect code.  I've adjusted the code accordingly:</p>
<pre><code class="csharp">    public string UserId
    {
        get
        {
            if (User == null)
            {
                throw new HttpResponseException(HttpStatusCode.Unauthorized);
            }
            var principal = User as ClaimsPrincipal;
            Claim cl = principal.Claims.FirstOrDefault(c =&gt; c.Type == ClaimTypes.NameIdentifier);
            return cl?.Value;
        }
    }
</code></pre>

<p>This is a little longer than the original one-liner, but it's more accurate.  This means that when I've forgotten what this particular method does in six months time, it will still do the right thing in all conditions.</p>
<div class="admonition tip">
<p class="admonition-title">Use Test-Driven Development</p>
<p>There is a whole school of thought on how to develop using testing as the driver known as <a href="https://en.wikipedia.org/wiki/Test-driven_development">Test Driven Development</a> or TDD.  In this school of thought, you write the tests first, ensuring you have 100% of the cases covered.  Your code is correct when the tests pass.  This method provides for very rapid development, but you do spend most of your time developing tests rather than code. </p>
</div>
<p>The other big class of testing to do is against custom APIs.   You can test these the same way.  For example, the standard scaffolding for an Azure Mobile Apps server contains a <code>ValuesController.cs</code>, which I have modified:</p>
<pre><code class="csharp">using System.Web.Http;
using Microsoft.Azure.Mobile.Server.Config;

namespace Backend.Controllers
{
    // Use the MobileAppController attribute for each ApiController you want to use
    // from your mobile clients
    [MobileAppController]
    public class ValuesController : ApiController
    {
        // GET api/values
        public string Get(string user)
        {
            return $&quot;Hello {user}!&quot;;
        }
    }
}
</code></pre>

<p>I can test this with the following:</p>
<pre><code class="csharp">using Backend.Controllers;
using Xunit;

namespace Backend.Tests.Controllers
{
    public class ValuesControllerTests
    {
        [Fact]
        public void Get_Name_Works()
        {
            var controller = new ValuesController();
            var result = controller.Get(&quot;adrian&quot;);
            Assert.Equal(&quot;Hello adrian!&quot;, result);
        }
    }
}
</code></pre>

<p>As with all other testing, ensure you think about all the things that could happen here, and test them all.  Ensure that the appropriate response is always returned and that you are never leave your server or a connected client in a bad state.  A big example of this in the case of mobile apps:  If a response is meant to be a JSON encoded version of an object on your client, ensure it can be deserialized to that object under all conditions.</p>
<h2 id="testing-your-mobile-client">Testing your Mobile Client<a class="headerlink" href="#testing-your-mobile-client" title="Permanent link">&para;</a></h2>
<h3 id="using-mock-data-services">Using Mock Data Services<a class="headerlink" href="#using-mock-data-services" title="Permanent link">&para;</a></h3>
<h3 id="unit-testing_1">Unit Testing<a class="headerlink" href="#unit-testing_1" title="Permanent link">&para;</a></h3>
<h2 id="end-to-end-testing">End to End Testing<a class="headerlink" href="#end-to-end-testing" title="Permanent link">&para;</a></h2>
<h3 id="introduction-to-xamarin-test-cloud">Introduction to Xamarin Test Cloud<a class="headerlink" href="#introduction-to-xamarin-test-cloud" title="Permanent link">&para;</a></h3>
<!-- Images -->

<!-- Links -->
              
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../developing/" title="The Development Environment" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                The Development Environment
              </span>
            </div>
          </a>
        
        
          <a href="../../chapter9/arm/" title="Repeatable Deployments" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Repeatable Deployments
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 Adrian Hall
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/adrianhall" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/FizzyInTheHall" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-30ac6a1727.js"></script>
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="../../js/highlight.pack.js"></script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-93366112-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>